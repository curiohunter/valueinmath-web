# 학원 관리 프로그램 진행 상황

## 프로젝트 개요
- **프로젝트명**: 학원 관리 시스템
- **목적**: 학생 정보 관리 및 학원 운영 효율화
- **시작일**: 2023년 5월 22일

## 완료된 기능
- [x] 기본 UI 구조 및 레이아웃 설정
- [x] 학생 목록 조회 및 필터링
- [x] 학생 등록/수정/삭제 기능
- [x] 학생 상태별 색상 구분 (재원, 퇴원, 휴원, 미등록)
- [x] 담당관별 색상 구분 (고등관, 중등관, 영재관)
- [x] 학생 메모 기능 구현
- [x] 종료일 필드 추가 및 Supabase 연동
- [x] 퇴원 상태 학생의 종료일 필수 검증
- [x] 검색 기능 개선
- [x] 직원 관리 기능 구현
  - [x] 직원 목록 조회 및 필터링
  - [x] 직원 등록/수정/삭제 기능
  - [x] 직원 상태별 색상 구분 (재직, 퇴직)
  - [x] 직책별 색상 구분 (원장, 부원장, 강사, 데스크직원, 데스크보조)
  - [x] 직원 메모 기능 구현
- [x] UI 개선
  - [x] 테이블 컬럼 정렬 문제 수정
  - [x] 메모와 관리 열 가운데 정렬 적용
  - [x] 직원 관리에서 불필요한 부서 필터 제거
- [x] 인증 기능 추가
  - [x] 로그인/회원가입 페이지 구현
  - [x] 비밀번호 재설정 기능 구현
  - [x] 인증 미들웨어 설정
  - [x] 직원과 사용자 계정 연결 기능 구현
  - [x] 사용자 프로필 테이블 생성 및 관리
  - [x] 새 사용자 등록 시 프로필 자동 생성 트리거 추가
  - [x] 프로필 테이블에 이메일 필드 추가 및 동기화 트리거 구현
  - [x] 기존 사용자를 위한 프로필 생성
  - [x] 회원 탈퇴(계정 삭제) 기능 구현 (user, profiles 삭제 및 /login 리디렉션)
- [x] 팀 채팅 기능 구현 (기본 기능)
  - [x] 채팅 데이터베이스 스키마 설계 및 생성
  - [x] 채팅방 생성 및 관리 기능
  - [x] 메시지 전송 및 수신 기능
  - [x] 계정 연결된 직원만 멤버로 선택 가능
  - [x] 메시지 읽음 상태 관리
  - [x] 사이드바에 채팅 메뉴 추가
  - [x] 회원 탈퇴 시 user, profiles 삭제 및 /login 리디렉션 처리 완료

## 진행 중인 기능
- [ ] 팀 채팅 기능 간소화 (진행률: 70%)
  - [x] 단일 채팅방으로 구조 변경
  - [x] 로그인한 모든 사용자 자동 참여
  - [x] 채팅 DB 구조 단순화
  - [ ] 채팅 UI 개선
    - [ ] 메시지 위치 스타일 수정 - 내 메시지는 오른쪽, 상대방 메시지는 왼쪽에 표시되도록 수정 필요
    - [ ] 스크롤 위치 문제 - 채팅방 입장 시 최신 메시지가 보이도록 수정 필요
    - [ ] 상대방 이름 표시 - UUID 대신 실제 이름이 표시되도록 수정 필요
    - [ ] 메시지 시간 표시 - "분 전" 대신 실제 날짜와 시간이 표시되도록 수정 필요
- [ ] 학생 상세 페이지 구현 (진행률: 0%)
- [ ] Supabase 연동 구현 (진행률: 95%)
- [ ] 인증 기능 추가 (진행률: 100%)
  - [ ] 인증 컨텍스트 구현
  - [ ] 권한 기반 접근 제어 구현
- [ ] 메모장 기능 개선 (진행률: 50%)
  - [ ] 메모장 UI 구현
  - [ ] 메모장 자동 저장 기능 추가
  - [ ] 메모장 내용 공유 기능

## 예정된 기능
- [ ] 대시보드 페이지 구현
  - [ ] 학생 통계 (상태별, 담당관별)
  - [ ] 직원 통계 (직책별, 부서별)
  - [ ] 최근 등록/퇴원 학생 목록
  - [ ] 월별 등록/퇴원 추이 그래프
- [ ] 엑셀 내보내기/가져오기 기능
  - [ ] 학생 목록 엑셀 내보내기
  - [ ] 직원 목록 엑셀 내보내기
  - [ ] 엑셀 파일에서 학생/직원 정보 가져오기
- [ ] 모바일 반응형 개선
  - [ ] 테이블 모바일 최적화
  - [ ] 폼 모바일 최적화
- [ ] 팀 채팅 고급 기능
  - [ ] 파일 첨부 기능
  - [ ] 메시지 편집/삭제 기능
  - [ ] 알림 기능
- [ ] 수업 일정 관리 기능
- [ ] 학습 관리 기능
- [ ] 통계 분석 기능

## 기술 스택
- **프론트엔드**: Next.js, React, TypeScript, Tailwind CSS, shadcn/ui
- **백엔드**: Next.js API Routes, Server Actions
- **데이터베이스**: Supabase (PostgreSQL)
- **인증**: Supabase Auth
- **실시간 통신**: Supabase Realtime
- **파일 저장소**: Supabase Storage

## 이슈 및 해결된 문제
- ✅ 퇴원 학생 종료일 필수 검증 개선 완료
- ✅ 검색 기능 작동 문제 해결 완료
- ✅ 전체 검색 바 제거 완료
- ✅ 담당관에서 "과학" 옵션 제거 완료
- ✅ 테이블 컬럼 정렬 문제 해결 완료
- ✅ 메모와 관리 열 가운데 정렬 적용 완료
- ✅ 직원 관리에서 불필요한 부서 필터 제거 완료
- ✅ 직원과 사용자 계정 연결 기능 구현 완료
- ✅ 사용자 프로필 테이블 생성 및 관리 완료
- ✅ 새 사용자 등록 시 프로필 자동 생성 트리거 추가 완료
- ✅ 프로필 테이블에 이메일 필드 추가 및 동기화 트리거 구현 완료
- ✅ 팀 채팅 기능 구현 완료
- ✅ 채팅방 멤버 선택 시 계정 연결된 직원만 표시되도록 수정 완료
- ❌ 채팅 UI 개선 - 메시지 위치 스타일 문제 (내 메시지는 오른쪽, 상대방 메시지는 왼쪽에 표시)
- ❌ 채팅 UI 개선 - 스크롤 위치 문제 (채팅방 입장 시 최신 메시지가 보이지 않음)
- ❌ 채팅 UI 개선 - 상대방 이름 표시 문제 (UUID 대신 실제 이름 표시)
- ❌ 채팅 UI 개선 - 메시지 시간 표시 문제 ("분 전" 대신 실제 날짜와 시간 표시)

## 다음 작업 우선순위
1. 채팅 UI 개선 - 메시지 위치, 스크롤 위치, 이름 표시, 시간 표시 문제 해결
2. 메모장 자동 저장 기능 추가
3. 인증 컨텍스트 구현
4. 권한 기반 접근 제어 구현
5. 학생 상세 페이지 구현
6. 대시보드 페이지 구현
7. 엑셀 내보내기/가져오기 기능
8. 모바일 반응형 개선

## 마지막 업데이트
- 날짜: 2025년 5월 23일
- 작업: 회원 탈퇴(계정 삭제) 기능 구현 및 배포 완료. 팀 채팅 기능은 반복된 오류와 v0 usage 소진으로 인해 DB 및 관련 코드 전체 삭제, 기능 전면 보류. (채팅 UI 개선 등도 중단)

## DB 스키마 업데이트시 
  supabase gen types typescript --project-id <프로젝트ID> --schema public > types/database.ts